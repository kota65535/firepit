vars:
  A: 1
  B: 2

tasks:
  foo:
    command: echo "foo {{ A }}"
    depends_on:
      - bar
      - task: baz
        vars:
          C: 4
      - task: qux
        vars:
          D: 5

  bar:
    env:
      B: "{{ B }}"
    command: echo "bar ${B}"
    depends_on:
      - baz
      - task: qux
        vars:
          E: 6

  baz:
    label: "{{ task }} {{ C }}"
    vars:
      C: 3
    command: echo "baz {{ C }}"
    depends_on:
      - task: "{% if C == 3 or C == 4 %}quux{% endif %}"
        vars:
          F: "{{ C }}"
      - "{% if A != 1 %}qux{% endif %}"

  qux:
    vars:
      D: 4
      E: 5
    command: |
      echo "qux {{ D }} {{ E }}"

  quux:
    vars:
      F: 6
    command: echo "quux {{ F }}"
